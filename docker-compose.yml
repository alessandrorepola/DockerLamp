version: "3.3"

services:
  www:
      build: .
      container_name: php-apache
      ports: 
          - "2001:80"
      volumes:
          - /mnt/www:/var/www/html/
      links:
          - db
      networks:
          - default
  db:
      image: mysql:8.0
      container_name: mysql
      ports: 
          - "3306:3306"
      command: --default-authentication-plugin=mysql_native_password
      environment:
          MYSQL_DATABASE: test_db
          MYSQL_USER: alessandro
          MYSQL_PASSWORD: password
          MYSQL_ROOT_PASSWORD: root 
      volumes:
          - ./dump:/docker-entrypoint-initdb.d
          - ./conf:/etc/mysql/conf.d
          - persistent:/var/lib/mysql
      networks:
          - default
  phpmyadmin:
      image: phpmyadmin/phpmyadmin
      container_name: phpmyadmin
      links: 
          - db:db
      ports:
          - 1609:80
      environment:
          MYSQL_USER: alessandro
          MYSQL_PASSWORD: password
          MYSQL_ROOT_PASSWORD: root 
volumes:
  persistent: